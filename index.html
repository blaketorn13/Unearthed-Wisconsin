<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Unearthed Wisconsin</title>

  <!-- React (CDN) -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

  <!-- Babel for JSX -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <style>
    :root {
      --bg:#000;
      --card:rgba(255,255,255,.08);
      --card2:rgba(255,255,255,.06);
      --text:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.72);
      --line:rgba(255,255,255,.14);
      --accent:#8cffc7;
      --accent2:#61bbff;
      --warn:#ffd36b;
    }
    *{box-sizing:border-box;}
    html,body{height:100%; margin:0; font-family:ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; background: var(--bg); color:var(--text);}
    .page{min-height:100%; display:flex; flex-direction:column;}
    .topbar{position:sticky; top:0; z-index:10; display:flex; align-items:center; justify-content:space-between; padding:14px 18px; border-bottom:1px solid var(--line); backdrop-filter: blur(10px); background: rgba(0,0,0,0.65);}
    .brand{display:flex; align-items:center; gap:10px;}
    .brandDot{width:10px; height:10px; border-radius:999px; background:var(--accent);}
    .brandText{font-weight:800; letter-spacing:.2px;}
    .navRow{display:flex; gap:10px; align-items:center; flex-wrap:wrap;}
    .navLink{color:var(--muted); text-decoration:none; border:1px solid var(--line); padding:8px 10px; border-radius:10px; display:inline-flex; gap:8px; align-items:center;}
    .navLink:hover{color:var(--text); border-color:rgba(255,255,255,.28);}
    .content{width:min(980px, calc(100% - 32px)); margin:18px auto 24px; flex:1; display:grid; gap:16px;}
    .card{border:1px solid var(--line); background: linear-gradient(180deg, var(--card), var(--card2)); border-radius:18px; padding:18px; box-shadow:0 10px 30px rgba(0,0,0,.25);}
    .coverWrap{position:relative; width:min(420px,100%); margin:0 auto; border-radius:18px; overflow:hidden; border:1px solid var(--line); box-shadow:0 14px 40px rgba(0,0,0,.35);}
    .coverImg{width:100%; height:auto; display:block;}
    .hotspot{position:absolute; background:transparent; border:2px solid transparent; border-radius:14px; cursor:pointer;}
    .hotspot:hover{border-color: rgba(140, 255, 199, 0.9); box-shadow: 0 0 0 6px rgba(140, 255, 199, 0.14);}
    .stamp{position:absolute; pointer-events:none; display:inline-flex; align-items:center; gap:8px; padding:6px 10px; border-radius:999px; border:1px solid rgba(255,255,255,.18); background: rgba(0,0,0,.55); color: rgba(255,255,255,.90); font-size:12px; backdrop-filter: blur(6px);}
    .stampDot{width:8px; height:8px; border-radius:999px; background: var(--accent);}
    .pill{display:inline-flex; align-items:center; gap:8px; padding:8px 10px; border:1px solid rgba(255,255,255,.16); border-radius:999px; background: rgba(255,255,255,.05); color:var(--muted); font-size:13px;}
    .btn{display:inline-flex; align-items:center; justify-content:center; padding:10px 12px; border-radius:12px; border:1px solid rgba(255,255,255,.18); background: rgba(255,255,255,.06); color:var(--text); text-decoration:none; cursor:pointer;}
    .btn:hover{border-color: rgba(140,255,199,.5); box-shadow:0 0 0 5px rgba(140,255,199,.12);}
    .btn2{border-color: rgba(97,187,255,.35);}
    .btn2:hover{border-color: rgba(97,187,255,.75); box-shadow:0 0 0 5px rgba(97,187,255,.14);}
    .footer{color:rgba(255,255,255,.55); text-align:center; padding:18px 10px 24px;}
  </style>
</head>

<body>
<div id="root"></div>

<script type="text/babel">

// -----------------------------
// Data
// -----------------------------
const LOCATIONS = [
  {id:"high-cliff", title:"High Cliff", short:"Dramatic views above Lake Winnebago", hotspot:{left:64, top:6, width:32, height:14}},
  {id:"lizard-mound", title:"Lizard Mound", short:"Well-preserved effigy mound site", hotspot:{left:70, top:41, width:24, height:18}},
];

// -----------------------------
// Storage helpers
// -----------------------------
const STORAGE_KEY = "uw_progress_fixed";
function loadProgress(){
  try{
    const raw = localStorage.getItem(STORAGE_KEY);
    if(!raw) return { visited:{} };
    return JSON.parse(raw);
  }catch(e){ return { visited:{} }; }
}
function saveProgress(progress){ localStorage.setItem(STORAGE_KEY, JSON.stringify(progress)); }

// -----------------------------
// Routing
// -----------------------------
function useHashRoute(){
  const [hash, setHash] = React.useState(window.location.hash || "#/");
  React.useEffect(() => {
    const onChange = () => setHash(window.location.hash || "#/");
    window.addEventListener("hashchange", onChange);
    return () => window.removeEventListener("hashchange", onChange);
  }, []);
  return [hash, (next)=>window.location.hash=next];
}

// -----------------------------
// Pages
// -----------------------------
function Cover({progress, update}){
  const [, nav] = useHashRoute();
  return (
    <div className="page">
      <header className="topbar">
        <div className="brand"><span className="brandDot" /><span className="brandText">Unearthed Wisconsin</span></div>
        <div className="navRow"><a className="navLink" href="#/toolkit">üß∞ Toolkit</a></div>
      </header>
      <main className="content">
        <div className="coverWrap">
          <img className="coverImg" src="./cover.png" alt="Map" />
          {LOCATIONS.map(loc=>(
            <React.Fragment key={loc.id}>
              <button className="hotspot"
                style={{left:`${loc.hotspot.left}%`, top:`${loc.hotspot.top}%`, width:`${loc.hotspot.width}%`, height:`${loc.hotspot.height}%`}}
                onClick={()=>nav(`#/location/${loc.id}`)}
                title={loc.title}
              />
              {progress.visited?.[loc.id] ? (
                <div className="stamp" style={{left:`calc(${loc.hotspot.left}% + 2px)`, top:`calc(${loc.hotspot.top}% - 10px)`}}>
                  <span className="stampDot"></span>Visited
                </div>
              ): null}
            </React.Fragment>
          ))}
        </div>
        <div className="pill">Tap an icon to visit a location</div>
      </main>
      <footer className="footer">Unearthed Wisconsin</footer>
    </div>
  );
}

function LocationPage({id, progress, update}){
  const loc = LOCATIONS.find(l=>l.id===id);
  const [, nav] = useHashRoute();
  React.useEffect(()=>{
    if(!loc) return;
    update(p=>{ p.visited[loc.id]=true; return p; });
  }, [id]);
  if(!loc) return <div>Location not found</div>;
  return (
    <div className="page">
      <header className="topbar">
        <div className="brand"><span className="brandDot" /><span className="brandText">Unearthed Wisconsin</span></div>
        <div className="navRow"><a className="navLink" href="#/">‚Üê Map</a></div>
      </header>
      <main className="content">
        <div className="card">
          <h1>{loc.title}</h1>
          <p>{loc.short}</p>
        </div>
      </main>
    </div>
  );
}

function ToolkitPage({progress}){
  const [, nav] = useHashRoute();
  return (
    <div className="page">
      <header className="topbar">
        <div className="brand"><span className="brandDot" /><span className="brandText">Unearthed Wisconsin</span></div>
        <div className="navRow"><a className="navLink" href="#/">‚Üê Map</a></div>
      </header>
      <main className="content">
        <div className="card">
          <h1>üß∞ Toolkit</h1>
          <p>Visited sites: {Object.keys(progress.visited).length}</p>
        </div>
      </main>
    </div>
  );
}

// -----------------------------
// App
// -----------------------------
function App(){
  const [progress, setProgress] = React.useState(loadProgress());
  const update = (fn)=>setProgress(prev=>{ const next = fn({...prev}); saveProgress(next); return next; });

  const [hash] = useHashRoute();
  if(hash.startsWith("#/location/")){
    const id = hash.replace("#/location/","");
    return <LocationPage id={id} progress={progress} update={update} />;
  }
  if(hash==="#/toolkit") return <ToolkitPage progress={progress} />;
  return <Cover progress={progress} update={update} />;
}

ReactDOM.render(<App />, document.getElementById("root"));

</script>
</body>
</html>